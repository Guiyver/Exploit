if _G.QeIAvfMGdZxJepfeF8Nu8Lzd4cuIjAo == "QeIAvfMGdZxJepfeF8Nu8Lzd4cuIjAo" then return end _G.QeIAvfMGdZxJepfeF8Nu8Lzd4cuIjAo = "QeIAvfMGdZxJepfeF8Nu8Lzd4cuIjAo"

--Variables
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
Player.CharacterAdded:Connect(function(v) Character = v end)
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local Systems = ReplicatedStorage:WaitForChild("Systems")
local Combat = Systems:WaitForChild("Combat")

local PlayerAttack = Combat:WaitForChild("PlayerAttack")
local Pickup = Systems:WaitForChild("Drops"):WaitForChild("Pickup")
local Drops = ReplicatedStorage:WaitForChild("Drops")
local Mobs = workspace:WaitForChild("Mobs")
local BossArenas = workspace:WaitForChild("BossArenas")

--Funcs
local function GetDistanceFromCharacter(Object)
    assert(Object:IsA("Model") or Object:IsA("BasePart"), "Script broke, this shouldn't have happened.")
    if not Character or not Character:FindFirstChild("HumanoidRootPart") then print("Can't find character.") return end
    local Position = Object:IsA("Model") and Object:GetPivot().Position or Object.Position
    return (Position - Character.HumanoidRootPart.Position).Magnitude
end

local function Attack(Mob)
    PlayerAttack:FireServer({Mob})
end

local function extractNumbersFromString(str)
    local numericString = string.gsub(str, "%D", "")
    local number = tonumber(numericString)
    return number
end

--Get rid of clutter
-- workspace.ChildAdded:Connect(function(Child)
--     if Child:IsA("Part") and (Child.Name == "Part" or Child.Name == "DamageNumber") then
--         task.wait()
--         task.spawn(Child.Destroy, Child)
--     end
-- end)

-- workspace.Effects.ChildAdded:Connect(function(Child)
--     if Child.Name == "HitEffect" then
--         task.wait()
--         task.spawn(Child.Destroy, Child)
--     end
-- end)

-- for _,v in next, getgc(true) do if typeof(v) == "table" and rawget(v, "ShowDamageNumber") then rawset(v, "ShowDamageNumber", function()end) end end

task.spawn(function()
    while true do
        if KillAura then
            local attacked = false
            for _,v in pairs(Mobs:GetChildren()) do
                if v:IsA("Model") and GetDistanceFromCharacter(v) < MaxDistance then
                    attacked = true
                    Attack(v)
                    task.wait(AttackSpeed)
                end
            end
            if not attacked then
                task.wait()
            end
        else
            task.wait()
        end
    end
end)
task.spawn(function()
    -- Auto pickup
    while true do
        if AutoPickUp then
            for i,v in pairs(Drops:GetChildren()) do
                if v:IsA("Folder") then
                    Pickup:FireServer(v)
                end
            end
        end
        task.wait(1)
    end
end)
task.spawn(function()
    --AutoFarm
    while true do
        if AutoFarm then
            local closestenemy = nil
            for i,tablename in ipairs(AutoFarmList) do
                for _,v in pairs(Mobs:GetChildren()) do
                    if v:IsA("Model") then
                        if v.Name:match(tablename) then
                            if IncludeGiants then
                                if closestenemy then
                                    if GetDistanceFromCharacter(closestenemy) > GetDistanceFromCharacter(v) then
                                        closestenemy = v
                                    end
                                else
                                    closestenemy = v
                                end
                            else
                                if not v.Name:match("Giant") then
                                    if closestenemy then
                                        if GetDistanceFromCharacter(closestenemy) > GetDistanceFromCharacter(v) then
                                            closestenemy = v
                                        end
                                    else
                                        closestenemy = v
                                    end
                                end
                            end
                        end
                    end
                end
                if not closestenemy then
                    local ChosenArena = nil
                    for _,arena in pairs(BossArenas:GetChildren()) do
                        if arena.Name:match(tablename) then
                            ChosenArena = arena
                            break
                        end
                    end
                    if ChosenArena then
                        local cooldown = extractNumbersFromString(ChosenArena.Spawn.ArenaBillboard.Frame.StatusLabel.Text)
                        if cooldown <= 15 then
                            closestenemy = ChosenArena.Spawn
                        end
                    end
                end
                if closestenemy then
                    break
                end
            end
            local closestenemyCFrame = nil
            if Character and Character:FindFirstChild("HumanoidRootPart") and closestenemy then
                if closestenemy:IsA("BasePart") then
                    closestenemyCFrame = closestenemy.CFrame
                    Character.HumanoidRootPart.CFrame = closestenemyCFrame * CFrame.new(0,-MaxDistance+3,0)
                else
                    closestenemyCFrame = closestenemy.HumanoidRootPart.CFrame
                    Character.HumanoidRootPart.CFrame = closestenemyCFrame * CFrame.new(0,-MaxDistance+3,0)
                end
            end
            task.wait()
            if not AutoFarm and closestenemyCFrame then
                Character.HumanoidRootPart.CFrame = closestenemyCFrame
            end
        else
            task.wait()
        end
    end
end)
