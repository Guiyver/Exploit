--V2
-- Settings
local Settings = {
    Cookie = "9DE67CDA47B85CC6F2013202BA10C915034B7188B834BE7365BEE8E6F22B46E54E444FC058DB626FAFD749535C4B1682F1B3CBAC6615538E0F707B0E95860792B72825D910AF11427BC11FE861E07851225EE6B30332CEBB0F5DDFF57B14E9DB0DBBB57E5AB9D26CDFAC22CCDFD2E6C5C615F8DB9F8C23336EBBA05C896F8C2582AD46C9B8B58D0A2FEC750C3A5553682FD33260B3805DE452F5309902BD069F338694BB426D9A80F947CF572C95FDD7F3F2AF196825941372BF1390676FD30CE46433BC118055A078AC01E3A387A1752AB0FB09673D379B8EF3CECA7BCE4C0F9630175D89CC9026ACE9FB95062C3632C52954CBBBEE3447ACAA9F32478D5341902238F80DC5615933A9A2A8D3055BEE2FB92576417CD1633B477DB9201EF3A5A21292F253436EAFE121563922CBE151BE2A7D6FD2F1C612F0BD571C0D9409816CA8940391A2293793F4DEF2DCF513ACC47C6C8FD337F4F98A2EDB8BA21DB6C630FA7FEE89D513F704D569A974D34A99DF79D975A9E3AF6E4930A8AF20F7BEBD0D016E5D2C588EB13BB5BBBB9FAA86671572431402623576039EF266A89A263A27DA0C2291021D2DC97C9E02C65F8CBCDA3516097AD35F083E23649EA3C4E688D75C06540772CEC850BBF5A8DF1C506213ABCF5C76F96E40CE8C8E4A8C8FDEF5A538D2A32699DF04D87357A290495C1953842DC1DFCBF2C6F26EDC0EF8BCFB679A195FBA18CA50BBD906AECDB98FB761937255F9E8565426236515EA8F511D4B59192A87D3A69932A4B458E479C82B26CAFBE98CE753BCD3088F72972B729F8748C042C22AF30DC0A4AF1ACAA0A0AA34A0FED69D46CA94ABF11ED5D866A6A527E94C0C848C6D6A2E937E30BCC9F467AB61A25F3A0DF9BC26D05FAFE14E859C166DDB9BE77CAC5BDADD6BD4723CF3B7A542068FB1B0A673E3AC77D6502B662874B52CD5AF3380B1325EC9A5400BDB51C48C2DF355FA90531682A46A7EBDFDEE1A069BA16B1347C871245B1CBB33AA98CB0A461A3CBA1B56D46BB566DC2E4A109DC6D33871F7DDF6468BFC5BF7B46387C063822D4A6D0660A2F64F726024E06369611F7141E7672005FD93B14C6208DD6ADD9E175B", -- Your cookie
    PlaceId = "7080389084", -- PlaceId of target's current game
    UserId = "5581029267", -- UserId of target
 }
 
 -- Objects
 local HttpService = game:GetService("HttpService")
 local Players = game:GetService("Players")
 local TeleportService = game:GetService("TeleportService")
 local RunService = game:GetService("RunService")
 
 local LocalPlayer = Players.LocalPlayer
 
 local RequestFunction
 if syn and syn.request then
    RequestFunction = syn.request
 elseif request then
    RequestFunction = request
 elseif http and http.request then
    RequestFunction = http.request
 elseif http_request then
    RequestFunction = http_request
 end
 
 local CsrfToken = ""
 local FakeUserAgent =  "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) discord/0.0.305 Chrome/69.0.3497.128 Electron/4.0.8 Safari/537.36"
 
 -- Functions
 local GetCsrfToken = function(Cookie)
    local Request = RequestFunction({
        Url = "https://auth.roblox.com/v2/logout",
        Method = "POST",
        Headers = {
            ["content-type"] = "application/json",
            ["user-agent"] = FakeUserAgent,
            ["cookie"] = ".ROBLOSECURITY=" .. Cookie
        }
    })
    return Request.Headers["x-csrf-token"]
 end
 
 local SafeRequest = function(Url, Method)
    return RequestFunction({
        Url = Url,
        Method = Method,
        Headers = {
            ["content-type"] = "application/json",
            ["user-agent"] = FakeUserAgent,
            ["cookie"] = ".ROBLOSECURITY=" .. Settings.Cookie,
            ["x-csrf-token"] = CsrfToken
        }
    })
 end
 
 -- Start
 if not RequestFunction then
    return print("Your executor does not support http requests.")
 end
 
 CsrfToken = GetCsrfToken(Settings.Cookie)
 
 if not CsrfToken then
    return print("The cookie you have entered is not valid.")
 end
 
 local Thumbnail = SafeRequest("https://www.roblox.com/headshot-thumbnail/json?userId=" .. Settings.UserId .. "&width=48&height=48", "GET")
 Thumbnail = HttpService:JSONDecode(Thumbnail.Body).Url
 
 local Index = 0
 repeat RunService.Heartbeat:Wait()
    local GameInstances = SafeRequest("https://www.roblox.com/games/getgameinstancesjson?placeId=" .. Settings.PlaceId .. "&startindex=" .. Index)
    pcall(spawn, function() GameInstances = HttpService:JSONDecode(GameInstances.Body) end)
    wait(0.2)
    if GameInstances and GameInstances.Collection and not GameInstances.StatusCode then
        for _,a in pairs(GameInstances.Collection) do
            for _,b in pairs(a.CurrentPlayers) do
                if b.Id == Settings.UserId or b.Thumbnail.Url == Thumbnail then
                    return TeleportService:TeleportToPlaceInstance(tonumber(Settings.PlaceId), a.Guid)
                end
            end
        end
        if Index > GameInstances.TotalCollectionSize then
            return print("Could not find game server.")
        end
        print(tostring(Index) .. "/" .. tostring(GameInstances.TotalCollectionSize) .. " servers scanned")
        Index = Index + 10
    end
 until nil
